unit fAnalys;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, Data.Win.ADODB, Vcl.StdCtrls,
  Vcl.Grids, Vcl.ExtCtrls;

type
  TForm1 = class(TForm)
    Panel1: TPanel;
    Panel2: TPanel;
    StringGrid1: TStringGrid;
    StringGrid2: TStringGrid;
    StringGrid3: TStringGrid;
    StringGrid4: TStringGrid;
    Button2: TButton;
    StringGrid5: TStringGrid;
    Edit1: TEdit;
    Button1: TButton;
    Qdan: TADOQuery;
    AC: TADOConnection;
    Qdandiagnos: TStringField;
    QdanData: TWideStringField;
    QdanCountDaignos: TIntegerField;
    QdancountDate: TIntegerField;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

uses fDM;

procedure TForm1.Button1Click(Sender: TObject);
var
  i: integer;
begin
  Qdan.Open;
  with StringGrid1 do
  begin
    ColWidths[1] := 200;
    RowCount := Qdan.RecordCount + 1; // настройка количества срок в stringgrid
    ColCount := Qdan.FieldCount;
    cells[0, 0] := 'Диагнос';
    cells[1, 0] := 'Возраст';
    cells[2, 0] := 'Х1';
    cells[3, 0] := 'X2';
    Qdan.First;
    while not Qdan.Eof do
      for i := 0 to Qdan.RecordCount - 1 do
      begin
        cells[0, i + 1] := Qdandiagnos.AsString;
        cells[1, i + 1] := QdanData.AsString;
        cells[2, i + 1] := QdanCountDaignos.AsString;
        cells[3, i + 1] := QdancountDate.AsString;
        Qdan.next;
      end;
  end;
  Qdan.Close;

end;

end.
