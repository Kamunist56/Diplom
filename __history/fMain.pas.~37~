unit fMain;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, System.Actions, Vcl.ActnList,
  Vcl.ActnMenus, Vcl.ToolWin, Vcl.ActnMan, Vcl.ActnCtrls,
  Vcl.PlatformDefaultStyleActnCtrls;

type
  TMain = class(TForm)
    ActionManager1: TActionManager;
    ActionToolBar1: TActionToolBar;
    ActionMainMenuBar1: TActionMainMenuBar;
    Action3: TAction;
    Action4: TAction;
    Action1: TAction;
    Action2: TAction;
    Action5: TAction;
    Action6: TAction;
    Action8: TAction;
    Action9: TAction;
    Action10: TAction;
    Action11: TAction;
    Action12: TAction;
    Action13: TAction;
    Action14: TAction;
    Action15: TAction;
    procedure Action10Execute(Sender: TObject);
    procedure Action4Execute(Sender: TObject);
    procedure Action9Execute(Sender: TObject);
    procedure Action6Execute(Sender: TObject);
    procedure Action13Execute(Sender: TObject);
    procedure Action14Execute(Sender: TObject);
    procedure Action11Execute(Sender: TObject);
    procedure Action1Execute(Sender: TObject);
    procedure Action2Execute(Sender: TObject);
    procedure Action5Execute(Sender: TObject);
    procedure Action12Execute(Sender: TObject);
    procedure Action15Execute(Sender: TObject);
    procedure Action3Execute(Sender: TObject);
  private
    procedure GetForm(InstanceClass: TComponentClass;Form:TForm);
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Main: TMain;

implementation

{$R *.dfm}

uses fAdress, fDM, fPac, fSector, cAdress, fSocStatus, fDiagnos,
  fPolisType, fGrInval, fPolikl, fDoctor, fVisit, fPosition, fWork, fAnalys;

procedure TMain.Action10Execute(Sender: TObject);
begin
  GetForm(TuAdress, uAdress);
  uAdress.show;
  dm.RefTable(dm.QBrowseAdress);
end;

procedure TMain.Action11Execute(Sender: TObject);
begin
  GetForm(TuPolikl, uPolikl);
  uPolikl.show;
  dm.qPoliklBrowse.Open;
end;

procedure TMain.Action12Execute(Sender: TObject);
begin
  GetForm(TuSocStatus, uSocStatus);
  uSocStatus.show;
  dm.QSocStatusBrowse.Open;
end;

procedure TMain.Action13Execute(Sender: TObject);
begin
  GetForm(TuPolisType, uPolisType);
  uPolisType.show;
  dm.QpolisTypeBrowse.Open;
end;

procedure TMain.Action14Execute(Sender: TObject);
begin
  GetForm(TuGrInval, uGrInval);
  uGrInval.show;
  dm.QGroupInvBrowse.Open;
end;

procedure TMain.Action15Execute(Sender: TObject);
begin
  GetForm(TuWork, uWork);
  uWork.show;
  dm.QWorkBrowse.Open;
end;

procedure TMain.Action1Execute(Sender: TObject);
begin
  GetForm(TuDoctor, uDoctor);
  uDoctor.show;
  dm.QDoctorBrowse.Open;
end;

procedure TMain.Action2Execute(Sender: TObject);
begin
  GetForm(TuVisit, uVisit);
  uVisit.show;
  dm.QVisitBrowse.Open;
end;

procedure TMain.Action3Execute(Sender: TObject);
begin
  analys.show;
end;

procedure TMain.Action4Execute(Sender: TObject);
begin
  GetForm(TPac, Pac);
  Pac.show;
  dm.QPacBrowse.Open;

end;

procedure TMain.Action5Execute(Sender: TObject);
begin
  GetForm(TuPosition, uPosition);
  uPosition.show;
  dm.QposBrowse.Open;
end;

procedure TMain.Action6Execute(Sender: TObject);
begin
  GetForm(TuDiagnos, uDiagnos);
  uDiagnos.show;
  dm.QDiagBrowse.Open;
end;

procedure TMain.Action9Execute(Sender: TObject);
begin
  GetForm(TuSector, uSector);
  uSector.show;
  dm.QBrowseSector.Open;
end;

procedure TMain.GetForm(InstanceClass: TComponentClass;Form:TForm);
var
  i: integer;
begin
  for i := 0 to MDIChildCount - 1 do
  begin
    if mdiChildren[i].Name = Form.Name then
      Application.CreateForm(InstanceClass, Form);
      break;
  end;
  Form.Show;
end;

end.
