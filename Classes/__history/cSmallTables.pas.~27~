unit cSmallTables;

interface

{
  Класс для работы с таблицами:
  locality, area, street, house_number
  Group_inval, Polis_type, Position, SocStatus
}
type
  TSmallTables = Class
  public
    id: integer;
    name: string;
    tableName: string;

    procedure GetAtr(Find_id: integer);
    procedure ChangeAtr(SmallTables: TSmallTables);
    procedure New(SmallTables: TSmallTables);
    procedure Del(idRecord: integer);
    constructor Create(name: String);
  End;

implementation

{ TSmall_tables }

uses fDM;

procedure TSmallTables.ChangeAtr(SmallTables: TSmallTables);
begin
  dm.QSmall_tables.Close;
  dm.QSmall_tables.SQL.Clear;
  dm.QSmall_tables.SQL.Add('update ' + SmallTables.tableName +
    ' set name=:name where id=:id');
  dm.QSmall_tables.Parameters.ParamValues['id'] := SmallTables.id;
  dm.QSmall_tables.Parameters.ParamValues['name'] := SmallTables.name;
  dm.QSmall_tables.ExecSQL;
end;

constructor TSmallTables.Create(name: String);
begin
  tableName := Name;
end;

procedure TSmallTables.Del(idRecord: integer);
begin
  dm.QSmall_tables.Close;
  dm.QSmall_tables.SQL.Clear;
  dm.QSmall_tables.SQL.Add('delete from ' + tableName + ' where id=:id');
  dm.QSmall_tables.Parameters.ParamValues['id'] := idRecord;
  dm.QSmall_tables.ExecSQL;
end;

procedure TSmallTables.GetAtr(Find_id: integer);
begin
  dm.QSmall_tables.Close;
  dm.QSmall_tables.SQL.Clear;
  dm.QSmall_tables.SQL.Add('select name from ' + name + ' where id=:id');
  dm.QSmall_tables.Parameters.ParamValues['id'] := Find_id;
  dm.QSmall_tables.Open;
  name := dm.QSmall_tables.FieldByName('name').AsString;
  id := Find_id;
end;

procedure TSmallTables.New(SmallTables: TSmallTables);
begin
  dm.QSmall_tables.Close;
  dm.QSmall_tables.SQL.Clear;
  dm.QSmall_tables.SQL.Add('insert ' + SmallTables.tableName +
    '(name) Values(:name)');
  dm.QSmall_tables.Parameters.ParamValues['name'] := SmallTables.name;
  dm.QSmall_tables.ExecSQL;
end;

end.
